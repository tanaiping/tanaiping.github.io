<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>花生地铁大数据</title>
	<link rel="stylesheet" href="css/base.css" />
	<link rel="stylesheet" href="css/subway.css" />
</head>
<body>
<div class="main-bg">
	<div class="main-wrap">
		<div class="subway-star">
			<div class="flow-wrap" style="display: none;">
				<div class="title">站点流向人数 TOP10</div>
				<!-- <div class="times-over"></div> -->
				<h3>站点流向<em>人数</em></h3>
				<ul>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">富锦路-中华北路</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">四平路-人民广场</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">佘山-宝山路</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">佘山-小南门</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">中山公园-陕西南路</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">-中华北路</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">富锦路-中华北路</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">富锦路-中华北路</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">富锦路-中华北路</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
					<li>
						<div class="flow-person"> 
							<span class="station-flow">富锦路-中华北路</span>
							<em class="station-num">115</em>
						</div>
						<div class="percent"><em style="width: 60%;"></em></div>
					</li>
				</ul>
			</div>
			<!-- 用户覆盖数 end  -->
			<div class="subway-wrap subway-opacity">
				<div id="main" style="width: 1500px;height:1200px; margin:0 auto;"></div>
				<div class="s1-1 station-box" station-name="罗湖"></div>
				<div class="s1-2 station-box" station-name="国贸"></div>
				<div class="s1-3 station-box" station-name="老街"></div>
				<div class="s1-4 station-box" station-name="大剧院"></div>
				<div class="s1-5 station-box" station-name="科学馆"></div>
				<div class="s1-6 station-box" station-name="华强路"></div>
				<div class="s1-7 station-box" station-name="岗厦"></div>
				<div class="s1-8 station-box" station-name="会展中心"></div>
				<div class="s1-9 station-box" station-name="购物公园"></div>
				<div class="s1-10 station-box" station-name="香蜜湖"></div>
				<div class="s1-11 station-box" station-name="车公庙"></div>
				<div class="s1-12 station-box" station-name="竹子林"></div>
				<div class="s1-13 station-box" station-name="侨城东"></div>
				<div class="s1-14 station-box" station-name="华侨城"></div>
				<div class="s1-15 station-box" station-name="世界之窗"></div>
				<div class="s1-16 station-box" station-name="白石洲"></div>
				<div class="s1-17 station-box" station-name="高新园"></div>
				<div class="s1-18 station-box" station-name="深大"></div>
				<div class="s1-19 station-box" station-name="桃园"></div>
				<div class="s1-20 station-box" station-name="大新"></div>
				<div class="s1-21 station-box" station-name="鲤鱼门"></div>
				<div class="s1-22 station-box" station-name="前海湾"></div>
				<div class="s1-23 station-box" station-name="新安"></div>
				<div class="s1-24 station-box" station-name="宝安中心"></div>
				<div class="s1-25 station-box" station-name="宝体"></div>
				<div class="s1-26 station-box" station-name="坪洲"></div>
				<div class="s1-27 station-box" station-name="西乡"></div>
				<div class="s1-28 station-box" station-name="固戍"></div>
				<div class="s1-29 station-box" station-name="后瑞"></div>
				<div class="s1-30 station-box" station-name="机场东"></div>

				<div class="s2-1 station-box" station-name="新秀"></div>
				<div class="s2-2 station-box" station-name="黄贝岭"></div>
				<div class="s2-3 station-box" station-name="湖贝"></div>
				<div class="s2-4 station-box" station-name="燕南"></div>
				<div class="s2-5 station-box" station-name="华强北"></div>
				<div class="s2-6 station-box" station-name="岗厦北"></div>
				<div class="s2-7 station-box" station-name="市民中心"></div>
				<div class="s2-8 station-box" station-name="福田"></div>
				<div class="s2-9 station-box" station-name="莲花西"></div>
				<div class="s2-10 station-box" station-name="景田"></div>
				<div class="s2-11 station-box" station-name="香梅北"></div>
				<div class="s2-12 station-box" station-name="香蜜"></div>
				<div class="s2-13 station-box" station-name="侨香"></div>
				<div class="s2-14 station-box" station-name="安托山"></div>
				<div class="s2-15 station-box" station-name="深康"></div>
				<div class="s2-16 station-box" station-name="侨城北"></div>
				<div class="s2-17 station-box" station-name="红树湾"></div>
				<div class="s2-18 station-box" station-name="科苑"></div>
				<div class="s2-19 station-box" station-name="后海"></div>
				<div class="s2-20 station-box" station-name="登良"></div>
				<div class="s2-21 station-box" station-name="海月"></div>
				<div class="s2-22 station-box" station-name="湾厦"></div>
				<div class="s2-23 station-box" station-name="东角头"></div>
				<div class="s2-24 station-box" station-name="水湾"></div>
				<div class="s2-25 station-box" station-name="海上世界"></div>
				<div class="s2-26 station-box" station-name="蛇口港"></div>
				<div class="s2-27 station-box" station-name="赤湾"></div>



				<div class="s3-1 station-box" station-name="双龙"></div>
				<div class="s3-2 station-box" station-name="南联"></div>
				<div class="s3-3 station-box" station-name="龙城广场"></div>
				<div class="s3-4 station-box" station-name="吉祥"></div>
				<div class="s3-5 station-box" station-name="爱联"></div>
				<div class="s3-6 station-box" station-name="大运"></div>
				<div class="s3-7 station-box" station-name="荷坳"></div>
				<div class="s3-8 station-box" station-name="永湖"></div>
				<div class="s3-9 station-box" station-name="横岗"></div>
				<div class="s3-10 station-box" station-name="塘坑"></div>
				<div class="s3-11 station-box" station-name="六约"></div>
				<div class="s3-12 station-box" station-name="丹竹头"></div>
				<div class="s3-13 station-box" station-name="大芬"></div>
				<div class="s3-14 station-box" station-name="木棉湾"></div>
				<div class="s3-15 station-box" station-name="布吉"></div>
				<div class="s3-16 station-box" station-name="草埔"></div>
				<div class="s3-17 station-box" station-name="水贝"></div>
				<div class="s3-18 station-box" station-name="田贝"></div>
				<div class="s3-19 station-box" station-name="翠竹"></div>
				<div class="s3-20 station-box" station-name="晒布"></div>
				<div class="s3-21 station-box" station-name="红岭"></div>
				<div class="s3-22 station-box" station-name="通新岭"></div>
				<div class="s3-23 station-box" station-name="华新"></div>
				<div class="s3-24 station-box" station-name="莲花村"></div>
				<div class="s3-25 station-box" station-name="少年宫"></div>
				<div class="s3-26 station-box" station-name="石厦"></div>
				<div class="s3-27 station-box" station-name="益田"></div>


				<div class="s4-1 station-box" station-name="清湖"></div>
				<div class="s4-2 station-box" station-name="龙华"></div>
				<div class="s4-3 station-box" station-name="龙胜"></div>
				<div class="s4-4 station-box" station-name="上塘"></div>
				<div class="s4-5 station-box" station-name="红山"></div>
				<div class="s4-6 station-box" station-name="深圳北站"></div>
				<div class="s4-7 station-box" station-name="白石龙"></div>
				<div class="s4-8 station-box" station-name="民乐"></div>
				<div class="s4-9 station-box" station-name="上梅林"></div>
				<div class="s4-10 station-box" station-name="莲花北"></div>
				<div class="s4-11 station-box" station-name="福民"></div>
				<div class="s4-12 station-box" station-name="福田口岸"></div>

				<div class="s5-1 station-box" station-name="怡景"></div>
				<div class="s5-2 station-box" station-name="太安"></div>
				<div class="s5-3 station-box" station-name="布心"></div>
				<div class="s5-4 station-box" station-name="百鸽笼"></div>
				<div class="s5-5 station-box" station-name="长龙"></div>
				<div class="s5-6 station-box" station-name="下水径"></div>
				<div class="s5-7 station-box" station-name="上水径"></div>
				<div class="s5-8 station-box" station-name="杨美"></div>
				<div class="s5-9 station-box" station-name="坂田"></div>
				<div class="s5-10 station-box" station-name="五和"></div>
				<div class="s5-11 station-box" station-name="民治"></div>
				<div class="s5-12 station-box" station-name="长岭陂"></div>
				<div class="s5-13 station-box" station-name="塘朗"></div>
				<div class="s5-14 station-box" station-name="大学城"></div>
				<div class="s5-15 station-box" station-name="西丽"></div>
				<div class="s5-16 station-box" station-name="留仙洞"></div>
				<div class="s5-17 station-box" station-name="兴东"></div>
				<div class="s5-18 station-box" station-name="洪浪北"></div>
				<div class="s5-19 station-box" station-name="灵芝"></div>
				<div class="s5-20 station-box" station-name="翻身"></div>
				<div class="s5-21 station-box" station-name="宝华"></div>
				<div class="s5-22 station-box" station-name="临海"></div>



				<div class="s7-1 station-box" station-name="洪湖"></div>
				<div class="s7-2 station-box" station-name="笋岗"></div>
				<div class="s7-3 station-box" station-name="红岭北"></div>
				<div class="s7-4 station-box" station-name="八卦岭"></div>
				<div class="s7-5 station-box" station-name="黄木岗"></div>
				<div class="s7-6 station-box" station-name="华强南"></div>
				<div class="s7-7 station-box" station-name="赤尾"></div>
				<div class="s7-8 station-box" station-name="福邻"></div>
				<div class="s7-9 station-box" station-name="皇岗口岸"></div>
				<div class="s7-10 station-box" station-name="皇岗村"></div>
				<div class="s7-11 station-box" station-name="沙尾"></div>
				<div class="s7-12 station-box" station-name="上沙"></div>
				<div class="s7-13 station-box" station-name="农林"></div>
				<div class="s7-14 station-box" station-name="深云"></div>
				<div class="s7-15 station-box" station-name="桃源村"></div>
				<div class="s7-16 station-box" station-name="龙井"></div>
				<div class="s7-17 station-box" station-name="珠光"></div>
				<div class="s7-18 station-box" station-name="茶光"></div>
				<div class="s7-19 station-box" station-name="西丽湖"></div>


				<div class="s9-1 station-box" station-name="文锦"></div>
				<div class="s9-2 station-box" station-name="向西村"></div>
				<div class="s9-3 station-box" station-name="人民南"></div>
				<div class="s9-4 station-box" station-name="鹿丹村"></div>
				<div class="s9-5 station-box" station-name="红岭南"></div>
				<div class="s9-6 station-box" station-name="红岭"></div>
				<div class="s9-7 station-box" station-name="园岭"></div>
				<div class="s9-8 station-box" station-name="泥岗"></div>
				<div class="s9-9 station-box" station-name="银湖"></div>
				<div class="s9-10 station-box" station-name="孖岭"></div>
				<div class="s9-11 station-box" station-name="梅村"></div>
				<div class="s9-12 station-box" station-name="下梅林"></div>
				<div class="s9-13 station-box" station-name="梅景"></div>
				<div class="s9-14 station-box" station-name="香梅"></div>
				<div class="s9-15 station-box" station-name="深圳湾公园"></div>
				<div class="s9-16 station-box" station-name="深湾"></div>
				<div class="s9-17 station-box" station-name="红树湾南"></div>

				
				<!-- 11 begin -->
				<div class="s11-1 station-box" station-name="南山"></div>
				<div class="s11-2 station-box" station-name="宝安"></div>
				<div class="s11-3 station-box" station-name="碧海湾"></div>
				<div class="s11-4 station-box" station-name="机场"></div>
				<div class="s11-5 station-box" station-name="机场北"></div>
				<div class="s11-6 station-box" station-name="福永"></div>
				<div class="s11-7 station-box" station-name="桥头"></div>
				<div class="s11-8 station-box" station-name="塘尾"></div>
				<div class="s11-9 station-box" station-name="马安山"></div>
				<div class="s11-10 station-box" station-name="沙井"></div>
				<div class="s11-11 station-box" station-name="后亭"></div>
				<div class="s11-12 station-box" station-name="松岗"></div>
				<div class="s11-13 station-box" station-name="碧头"></div>
				
			</div>
		</div>
		<!-- subway end  -->
	</div>
</div>
<script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="js/echarts.min.js"></script>
<script type="text/javascript" src="js/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="js/parallax.js"></script>
<script>
	$(function(){
		getUserData();
		setInterval(getUserData,3000);

		//
		function getUserData(){
			var mydate = new Date();
			var h = mydate.getHours(); //获取当前小时数(0-23)
			var m = mydate.getMinutes(); //获取当前分钟数(0-59)
			var s = mydate.getSeconds(); //获取当前秒数(0-59)
			if (h<10) {h = "0" +h;}
	        if (m<10) {m = "0" +m;}
	        if (s<10) {s = "0" +s;}
			var time_text = h+":"+m+":"+s;
			$("#time").text(time_text);
		}

		//移入站点出来站点名称以及人数,移出隐藏
		var stationTimeout;
		$(".station").hover(function(){
			clearTimeout(stationTimeout);
			var obj = $(this).parents(".subway-wrap");
			var $this_left = parseInt($(this).css("left"))-87;
			var $this_top = parseInt($(this).css("top"))+13-128;
			if($(".tips-station").length==0){
				obj.append('<div class="tips-station"><div class="tips-box">'+
						   '<p>站台：<em id="station_name"></em></p>'+
						   '<p>人数：<em>153254</em></p></div></div>');
			}else{
				$(".tips-station").show();
			}
			$("#station_name").text($(this).attr("station-name"));
			$(".tips-station").css({"left":$this_left+"px","top":$this_top+"px"});
		},function(){
			stationTimeout = setTimeout(function(){$(".tips-station").hide();},100);
		});
		$(".subway-wrap").on("mouseover",".tips-station",function(){
	      clearTimeout(stationTimeout);
	    });
	    $(".subway-wrap").on("mouseout",".tips-station",function(){
	      stationTimeout = setTimeout(function(){$(".tips-station").hide();},100);
	    });


		// 基于准备好的dom，初始化echarts图表
    var myChart = echarts.init(document.getElementById('main'));
    var  data = []; 
    var coords = []; 
    
	var links = [];

	var colors = ['#44fd20', '#20fd92', '#20f0fd', '#f5fd20', '#7320fd', '#fdf020', '#e80c9d', '#e80c9d', '#fb048f', '#e80c21', '#fb0404'];

	function getColorPalette(i) {
	    return colors[i];
	}
		option = {
		    title: {
		        text: ''
		    },
		    tooltip: {},
		    xAxis: {
		        show: false,
		        // type : 'category',
		        // boundaryGap : false,
		        // data : axisData
		        type: 'value',
		        min: 0,
		        max: 1500,
		    },
		    yAxis: {
		        show: false,
		        type: 'value',
		        min: 0,
		        max: 1200,
		        inverse: true
		    },
		    dataRange: {
		        min: 0,
		        max: 600,
		        y: '60%',
		        calculable: true,
		        color: ['#d20528', 'orange', 'yellow', 'lime', 'aqua'],
		        show:false
		    },
		    grid: {
		          containLabel: true,
		          top: '28',
		          bottom: '0',
		          left: '-20',
		          right: '0'
		      },
		    series: [{
		        type: 'effectScatter',  //波纹 graph effectScatter
		        // rippleEffect: {
		        //     brushType: 'stroke'
		        // },
		        layout: 'none',
		        roam:true,
		        coordinateSystem: 'cartesian2d',
		        symbolSize: 12,
		        edgeSymbol: ['none', 'arrow'], // ['none', 'arrow'] ['circle', 'arrow']
		        edgeSymbolSize: [2, 10],
		        data: data,
		        links: links,
		        label: {
		            normal: {
		                show: true,
		                position: 'right',//显示位置
		                offset:[5, 0], //偏移设置
		                formatter: '{b}', //圆环显示文字
		                color:"#00FFFC",
		                fontSize:14
		            },
		            emphasis: {
		              show: true,
		            }
		        }
		    }, {
		        name: '',
		        type: 'lines',
		        coordinateSystem: 'cartesian2d',
		        zlevel: 1,
			    effect: {
		              show: true,
		              period: 3,
		              trailLength: 0.01,
		              symbolSize: 13,
		              symbol: "triangle",
		              //color:'rgba(55,155,255,0.5)'
		          },
		        lineStyle: {
		            normal: {
		                color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
		                    offset: 0,
		                    color: 'rgb(255, 0, 0)'
		                }, {
		                    offset: 1,
		                    color: 'rgb(0, 255, 0)'
		                }]),
		                color:'#a0a0a0',
		                color: function() {
		                    return getColorPalette(3);
		                }(),
		                width: 2,
		                opacity: 0.6,
		                curveness: 0.2,//贝塞尔曲线度
		                type:"dotted"
		            }
		        },
		        data: coords
		    }]
		};
   
	getEchartsData();
	setInterval(getEchartsData,18000);
    // 为echarts对象加载数据 
    myChart.setOption(option); 

    	//获取echarts数据 并组装数据
    	function getEchartsData(){
    		var stationData = ["碧头","宝安中心","洪浪北","深圳北站","布吉","黄贝岭","老街","会展中心","下水径","坪洲","大新","大学城","白石龙","科学馆","深圳湾公园","双龙"];
		    var valueData =[420,158,,420,,556,,420,,420,,420,,420];
		    //组装data数据
		    for(var y=0;y<stationData.length;y++){
		    	var param =[];
		    	var sta_name =stationData[y];
		    	$(".station-box").each(function(){
					if($(this).attr("station-name")===sta_name){
						var left = parseInt($(this).css("left"));
						var top = parseInt($(this).css("top"));
						param.push(left);
						param.push(top);
					}
				})
				data.push({"name":stationData[y],"value":param});
		    }
		     console.log( JSON.stringify(data));
		    //组装画线的数据
		    for(var x=0;x<data.length;x+=2){
		    	var coord1 = [];
		    	var coord2 = [];
		    	var coord = [];
		    	// var coord = [];
		    	var left1 = data[x].value[0];
		    	var top1 = data[x].value[1];
		    	coord1.push(left1);
		    	coord1.push(top1);
		    	coord.push({"coord":coord1});
		    	left1 = data[(x+1)].value[0];
		    	top1 = data[(x+1)].value[1];
		    	coord2.push(left1);
		    	coord2.push(top1);
		    	coord.push({"coord":coord2,"value":valueData[x/2]});
		    	coords.push(coord);
		    }
		    console.log( JSON.stringify(coords)+"====coords");
    	}

    	
	})
</script>
</body>
</html>